<div class="app">
  <aside class="sidebar" aria-label="Primary navigation" style="display:none">
    </aside>

  <main class="main">
    <div class="topbar">
  <div class="search" style="display:flex;align-items:center;gap:10px">
    <button class="btn" id="toggleSidebar">☰</button>
    <input type="text" placeholder="Search patient name or student number..." style="padding:10px;border-radius:8px;border:1px solid rgba(0,0,0,0.06)">
  </div>

  <div id="current-datetime" style="margin-left:12px;color:var(--muted);align-self:center;font-weight:600"></div>

  <div class="actions" style="display:flex;gap:10px;align-items:center">
    <div style="color:var(--muted); display:flex; align-items:center; gap:10px">Notifications <span style="background:#7c3aed;border-radius:10px;padding:4px 8px;font-weight:700;color:white">3</span></div>
    <button class="btn" id="newEncounterTopBtn">New Encounter</button>
  </div>
</div>


    <section class="grid" style="display:grid;grid-template-columns:1fr 360px;gap:18px;align-items:start;padding-top:16px">
      <div class="left" style="display:grid;grid-template-rows:auto auto;gap:18px">
        <div class="kpis" style="display:flex;gap:12px">
          <div class="kpi card"><div class="num">24</div><div class="label" style="color:var(--muted)">Patients checked-in today</div></div>
          <div class="kpi card"><div class="num">31</div><div class="label" style="color:var(--muted)">Encounters today</div></div>
          <div class="kpi card"><div class="num">5</div><div class="label" style="color:var(--muted)">Pending referrals</div></div>
        </div>

        <div class="charts" style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
          <div class="card"><h3>Visits Over Time</h3><div class="placeholder">[Line chart placeholder]</div></div>
          <div class="card"><h3>Top 5 Chief Complaints</h3><div class="placeholder">[Bar chart placeholder]</div></div>
          <div class="card"><h3>Diagnoses Distribution</h3><div class="placeholder">[Pie chart placeholder]</div></div>
          <div class="card"><h3>Vitals Quick View</h3><div class="placeholder">[Sparklines / mini-cards]</div></div>
        </div>
      </div>

      <aside class="right" style="display:flex;flex-direction:column;gap:12px">
        <div class="card recent">
          <h3>Recent Encounters</h3>
          <div class="row" style="display:flex;justify-content:space-between;padding:8px;border-radius:8px;background:rgba(255,255,255,0.01)"><div>Juan Dela Cruz — Fever</div><div style="color:var(--muted)">09:42</div></div>
          <div class="row" style="display:flex;justify-content:space-between;padding:8px;border-radius:8px;background:rgba(255,255,255,0.01)"><div>Maria Santos — Wound</div><div style="color:var(--muted)">09:35</div></div>
          <div class="row" style="display:flex;justify-content:space-between;padding:8px;border-radius:8px;background:rgba(255,255,255,0.01)"><div>Pedro Reyes — Cough</div><div style="color:var(--muted)">09:10</div></div>
          <div class="row" style="display:flex;justify-content:space-between;padding:8px;border-radius:8px;background:rgba(255,255,255,0.01)"><div>Lisa Ong — Headache</div><div style="color:var(--muted)">08:57</div></div>
        </div>

        <div class="card quick">
          <h3>Quick Actions</h3>
          <div style="display:flex; gap:8px; flex-wrap:wrap">
            <button class="btn" id="regPatientDashBtn">Register Patient</button>
            <button class="btn" id="recordVitalsDashBtn">Record Vitals</button>
            <button class="btn" id="exportCensusDashBtn">Export Census</button>
          </div>
        </div>

        <div class="card">
          <h3>Alerts</h3>
          <div style="color:var(--muted); font-size:13px">Low stock: Paracetamol (20 left)</div>
          <div style="color:var(--muted); font-size:13px; margin-top:8px">Correction requests: 2</div>
        </div>
      </aside>
    </section>
  </main>
</div>

<script>
  // update current date & time every second
  function updateDateTime(){
    const el = document.getElementById('current-datetime');
    if(!el) return;
    const now = new Date();
    // format: Wed, Nov 26 2025 — 14:03:05
    const dateStr = now.toLocaleDateString(undefined, { weekday:'short', month:'short', day:'numeric', year:'numeric' });
    const timeStr = now.toLocaleTimeString();
    el.textContent = `${dateStr} — ${timeStr}`;
  }
  updateDateTime();
  setInterval(updateDateTime, 1000);

  // New Encounter (top button)
  document.getElementById('newEncounterTopBtn')?.addEventListener('click', () => {
    window.dispatchEvent(new CustomEvent('app:navigate', { detail: { page: 'encounter' } }));
  });

  // Register Patient (Quick Actions)
  document.getElementById('regPatientDashBtn')?.addEventListener('click', () => {
    alert('Open patient registration modal (implement later).');
  });

  // Record Vitals (Quick Actions)
  document.getElementById('recordVitalsDashBtn')?.addEventListener('click', () => {
    alert('Open record vitals modal (implement later).');
  });

  // Export Census (Quick Actions)
  document.getElementById('exportCensusDashBtn')?.addEventListener('click', () => {
    if(window.exportCsv){
      window.exportCsv('census_report.csv', "name,encounters\nJuan Dela Cruz,3\nMaria Santos,2\n");
      alert('Census exported as CSV.');
    }
  });
</script>