<section class="page">
  <div style="max-width:480px;margin:40px auto">
    <div class="card">
      <h2>Create account</h2>
      <p style="color:var(--muted)">Create a demo account (client-side only).</p>

      <div style="margin-top:12px;display:flex;flex-direction:column;gap:10px">
        <input id="su-name" class="input" type="text" placeholder="Full name" />
        <input id="su-email" class="input" type="email" placeholder="Email (or username)" />
        <input id="su-pass" class="input" type="password" placeholder="Password" />
        <label style="font-size:13px;color:var(--muted)">Avatar (optional):</label>
        <input id="su-avatar" type="text" class="input" placeholder="URL path to avatar image (optional)" />
        <div style="display:flex;gap:8px">
          <button id="signupBtn" class="btn">Create account</button>
          <button id="gotoLogin" class="btn secondary">Back to sign in</button>
        </div>
        <div id="signup-msg" style="color:var(--muted);font-size:13px"></div>
      </div>
    </div>
  </div>
</section>

<script>
  document.getElementById('signupBtn').addEventListener('click', ()=>{
    const name = document.getElementById('su-name').value.trim();
    const email = document.getElementById('su-email').value.trim();
    const pass = document.getElementById('su-pass').value;
    const avatar = document.getElementById('su-avatar').value.trim();

    if(!name || !email || !pass){ document.getElementById('signup-msg').textContent = 'Please fill required fields.'; return; }

    const users = JSON.parse(localStorage.getItem('ehr_users') || '[]');
    if(users.some(u => u.email === email || u.name === name)){ document.getElementById('signup-msg').textContent = 'User already exists.'; return; }

    users.push({ name, email, password: pass, avatar: avatar || '' });
    localStorage.setItem('ehr_users', JSON.stringify(users));

    // sign in new user
    localStorage.setItem('ehr_user', JSON.stringify({ name, avatar: avatar || '' }));
    window.dispatchEvent(new CustomEvent('app:navigate', { detail: { page: 'dashboard' } }));
  });

  document.getElementById('gotoLogin').addEventListener('click', ()=>{
    window.dispatchEvent(new CustomEvent('app:navigate', { detail: { page: 'login' } }));
  });
</script>
